Moodle auth plugin docs:
https://docs.moodle.org/dev/Authentication_plugins

Moodle oidc
https://moodle.org/plugins/auth_oidc


//private key oly the server should knows
jwt.login({payloadobject}, privatekey, {expiresIn: '1h'});

claims - attr dos objetos
payload - possuem attrs privados e públicos Ex: sub: email da pessoa, iss: 'aplicacao'
Header e Boy codificados em base64


funções úteis:
base64_encode
hash_hmac('sha256', txt)

Fluxo:
usuário manda os dados para autenticaçã0


$user = authenticate_user_login($username, null, true);

Documentação para autenticação:
https://docs.google.com/document/d/1H7Pe8uPqeaIrsB-YU5NAqjWHSRhVYCD-Du3ammGyXcM/edit


ATENÇÃO
Analisar bem o fluxo do handleredirect. Lá é verificado oq fazer:
    - handlecertadminconsentresponse // lida com session do moodle e post request token access. registro de envento qd o usuário pega um token


------------------------------------
Infomações Lucas:

Url para login inicial (primeiro redirect):
https://develop-login-integracao-dot-scanner-prova.rj.r.appspot.com/login
Producao:
https://plataforma-integrada.nees.ufal.br/login

Usuário teste homologação (login) primeira tela (credencial administrativa):
06976983430
ydVZmibxFK@GDb#WrQ6loj5l&VK8Zw

Trocar pelo localhost. Request via get para pegar os tokens (para teste). Ja pode ser o link de logar com GOVBR
https://rieh-hmg.nees.ufal.br/repositorio?accessToken=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNjc1NzE0OTc0LCJpYXQiOjE2NzU3MTMxNzQsImp0aSI6ImZkYTY2YmYwMmNiZTRjMGJiNjI0MzlhOTA3MDllYmM4IiwidXNlcl9pZCI6IjA2OTc2OTgzNDMwIn0.gvzoBhkIeTl13RHmmt8KIxjGhRes5ryedyj8mR2CjAQ&refreshToken=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbl90eXBlIjoicmVmcmVzaCIsImV4cCI6MTY3NTc5OTU3NCwiaWF0IjoxNjc1NzEzMTc0LCJqdGkiOiJkOWU4NDE2N2I2YjM0YmMyYjBlMzU4MGFhYmZjYTI1MiIsInVzZXJfaWQiOiIwNjk3Njk4MzQzMCJ9.RMJPDNN6bbIlUWVsi9jdtA0fLzpZTCmL7TKcfvhEDl8&userProfile=755472
Pegar esses dois valores em uma página do request

Validar o token do usuário:

HEADER:
"Content-Type": "application/json",
"Authorization": "Bearer " + access_token,
"id-profile": user_profile

//valor da constante passada por Lucas:
RBEH_REPO_MODULE_ID=11
https://develop-api-login-integracao-dot-scanner-prova.rj.r.appspot.com/govbr/user/info/{RBEH_REPO_MODULE_ID}
Producao:
https://plataforma-integrada.nees.ufal.br/govbr/user/info/{RBEH_REPO_MODULE_ID}
Retorna um json com info do usuário. CPF do usuário;









